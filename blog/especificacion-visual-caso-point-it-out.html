<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.png" />
		<meta name="color-scheme" content="dark" />		
		<!-- Color for browser url bar in mobile/Safari -->
		<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#222222" />
		<!-- Disable Google FLOC -->
		<meta http-equiv="Permissions-Policy" content="interest-cohort=()" />
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0" />
		<meta property="og:type" content="website" />


		<script>
			// Calling this here so that it loads as quickly as possible
			// Avoiding a flash of light mode in case dark mode is used
			const theme = localStorage.getItem('theme-preference') || 'auto';
			document.firstElementChild?.setAttribute('data-theme', theme);
		</script>
		
		<link href="../_app/immutable/assets/4.ClJVwGEW.css" rel="stylesheet">
		<link href="../_app/immutable/assets/styles.B8Lq6qEL.css" rel="stylesheet">
		<link href="../_app/immutable/assets/InfoBox.DvHn1tL4.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Code.j_zGn_sg.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Image.DuFpa1HE.css" rel="stylesheet">
		<link href="../_app/immutable/assets/ColumnsContainer.B6dEa0-C.css" rel="stylesheet">
		<link href="../_app/immutable/assets/utils.qL9-CBIZ.css" rel="stylesheet">
		<link href="../_app/immutable/assets/18.BWf-Qbmh.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Z99xSRbY.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BI7sRbXH.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DXvr5MkK.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dklkudmk.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DIeogL5L.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CPg8peRc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CbR4jyub.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CtRAiEqP.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D15U5vI1.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/B_a822e4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DV43qqAu.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.DQ3YaMDD.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dp1pzeXC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CWj6FrbW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_anfbMuE.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Cp_mNyVe.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CWoHNtTF.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CmBYzWmm.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BNMlDoAB.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.DymBJuXx.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BTGqeDDF.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CqkleIqs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C-pAAiiO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BQ15y-oL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DCpcKDkW.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/4.Bw9j88qB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/69_IOA4Y.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dd8tYW3K.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/j1b29jXt.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dv4WNOD4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/bWBFZa-U.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CIeRTlPl.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/j2RxxnUs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CMx9FFQA.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/6.BLFObSSA.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/18.uFZYlMbj.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/-Ps3mLNN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/zdoSjCt0.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/RmmjoSf4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/aNrYXyrR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Z4UNFkoY.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CjFALAzN.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CBmlR6vQ.js"><!--[--><!--[--><!--]--> <!--[--><meta name="robots" content="index,follow"/><!--]--> <!--[--><meta name="description" content="Caso de un proyecto en activo para el que repaso el concepto de regresión visual y especificación visual. Contenido denso."/><!--]--> <!--[--><link rel="canonical" href="https://alexvega.net/blog/especificacion-visual-caso-point-it-out"/><!--]--> <!--[--><meta name="keywords" content="svg, regresión visual, visual testing"/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[--><!--[--><meta name="twitter:card" content="summary"/><!--]--> <!--[!--><!--]--> <!--[--><meta name="twitter:title" content="Especificación visual. Caso Point it out!"/><!--]--> <!--[--><meta name="twitter:description" content="Caso de un proyecto en activo para el que repaso el concepto de regresión visual y especificación visual. Contenido denso."/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[--><meta name="twitter:image" content="https://alexvega.net/_app/immutable/assets/pio-round-fail-test.-sGo8TTQ.png"/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!--]--> <!--[!--><!--]--> <!--[--><!--[--><meta property="og:url" content="https://alexvega.net/blog/especificacion-visual-caso-point-it-out"/><!--]--> <!--[!--><!--]--> <!--[--><meta property="og:title" content="Especificación visual. Caso Point it out!"/><!--]--> <!--[--><meta property="og:description" content="Caso de un proyecto en activo para el que repaso el concepto de regresión visual y especificación visual. Contenido denso."/><!--]--> <!--[--><!--[--><meta property="og:image" content="https://alexvega.net/_app/immutable/assets/pio-round-fail-test.-sGo8TTQ.png"/> <!--[--><meta property="og:image:alt" content="Alex Vega site logo"/><!--]--> <!--[--><meta property="og:image:width" content="1280"/><!--]--> <!--[--><meta property="og:image:height" content="720"/><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!--]--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!--]--> <!--[!--><!--]--> <!--[!--><!--]--><!--]--><!--[--><link rel="stylesheet" href="/blog.css"/><!--]--><title>Especificación visual. Caso Point it out!</title>
	</head>
	<body data-sveltekit-preload-data="hover" class="loading">
		<div class="hydration-protection-wrapper__dont-remove" 
			 style="display: contents"><!--[--><!--[--><!----><!--[--><!----><!----> <!--[--><div class="nav-fade-overlay svelte-oabbd1"></div> <nav class="main-nav svelte-oabbd1"><a class="main-nav__link svelte-oabbd1" tabindex="-1" href="/">Inicio</a> <a class="main-nav__link svelte-oabbd1" tabindex="-1" href="/#contacto">Contacto</a> <a class="main-nav__link svelte-oabbd1" tabindex="-1" href="/blog">Blog</a> <button class="main-nav__button svelte-oabbd1" tabindex="1" aria-busy="true" title="Desplegar menú de navegación" aria-label="Desplegar menú de navegación"></button></nav><!--]--> <!--[--><div class="loader svelte-14xshfi"><div class="loader__spinner svelte-14xshfi"></div></div><!--]--> <main class="svelte-1pvwjww main--loading"><!----><!--[--><!----><!----><!----><!--[--><div class="cover svelte-s7hptc cover--top"><!--[!--><!--]--> <!--[!--><picture><!--[--><source srcset="/_app/immutable/assets/pio-round-fail-test.DX0Cn6lJ.avif 1x, /_app/immutable/assets/pio-round-fail-test.CmaCatt2.avif 2x" type="image/avif"/><source srcset="/_app/immutable/assets/pio-round-fail-test.Dw2-sPvT.webp 1x, /_app/immutable/assets/pio-round-fail-test.DFm94EAo.webp 2x" type="image/webp"/><source srcset="/_app/immutable/assets/pio-round-fail-test.BPuwgNjn.png 1x, /_app/immutable/assets/pio-round-fail-test.-sGo8TTQ.png 2x" type="image/png"/><!--]--> <img src="/_app/immutable/assets/pio-round-fail-test.-sGo8TTQ.png" alt="Portada del post" class="cover__img svelte-s7hptc" width="1280" height="720"/></picture><!--]--></div><!--]--> <article class="post svelte-1js559p" style="margin-top: 0px"><header class="post__header svelte-1js559p"><h1 class="post__title svelte-1js559p">Especificación visual. Caso Point it out!</h1> <div class="post__meta-row svelte-1js559p"><!--[--><div class="post__date svelte-1js559p">25 de julio de 2024</div><!--]--> <!--[--><div class="post__tags svelte-1js559p"><!--[--><a class="tag svelte-rpb2ex" href="/tag/tdd-bdd-atdd">TDD/BDD/ATDD</a><a class="tag svelte-rpb2ex" href="/tag/tooling">Tooling</a><a class="tag svelte-rpb2ex" href="/tag/dx">DX</a><!--]--></div><!--]--></div></header> <!----><p>He tenido la necesidad de crear formas posicionables sobre sitios web,
señalando o conectando elementos. Muchas veces. Es un must en aplicaciones
interactivas que requieren de algún tipo de señalización, como podría ocurrir
en tutoriales.</p> <p>Harto de reinventar la rueda decido buscar una biblioteca sencillita que me
resuelva este problema. Esperaba encontrar muchas para ello, o quizás
como alguna feature de alguna muy gorda y conocida.
Estaba casi convencido de que existiría algo, pero que aún así quizás tendría que
hacer yo mismo una biblioteca propia con <strong>filosofía minimalista</strong>.</p> <p>Pero lo cierto es que, al menos en unas pocas búsquedas sencillas, no he
encontrado nada. Que no sea fácil de encontrar no significa que no exista,
no te imaginas cuántas superherramientas sin visibilidad he encontrado entre
repositorios perdidos.</p> <p>A falta de soluciones (o como resultado de una mala investigación), me pongo
manos a la obra en el desarrollo de una biblioteca para ello (Point it out) y
me doy cuenta de que necesito algo para especificar qué resultado visual busco.
Necesito alguna técnica de <strong>especificación visual</strong>, si es que existe algo
así y si significa lo que pretendo que signifique.</p> <h2>Describiendo el problema: cómo señalizar elementos</h2> <p>Por ejemplo, ¿qué podría hacer si quisiera
señalizar <span class="no-wrap svelte-49cqox"><!----><span id="example-target" class="hl">estas palabras</span><!----></span><!---->?
Si todo funciona bien deberías estar viendo un rectángulo verde sobre las palabras indicadas.</p> <p>“Pero Alexander, ¿me estás diciendo que ya existe entonces solución?” No, lo que
estás viendo es fruto del resultado final (o al menos de lo que ya tengo
desarrollado). Dado que ya tengo una medio solución, ¿por qué no mostrarlo?</p> <div class="info-box svelte-um5er8"><!--[!--><!--]--> <!----><p>AVISO: ¿Estás buscando un tutorial paso a paso de cómo
desarrollar una biblioteca de manera profesional? Pues este NO es el lugar.
Solo encontrarás fragmentos de código relevantes para plantear el temita
de la especificación visual.</p><!----></div><!----> <p>En una primera versión, la biblioteca debía aportar al menos un primer mecanismo simple de
señalización. Para ello especifiqué la siguiente función:</p> <div class="code-wrapper svelte-pnnny8" style="--lang-color: #3178c6"><!--[--><div class="code-wrapper__lang svelte-pnnny8">TypeScript</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-typescript svelte-pnnny8"><!----><!---->create(shape: ShapeName, {target: string | HTMLElement})<!----></code></pre></div><!----> <p><code>ShapeName</code> se trata de una string, un tipo de unión ‘rect’ | ‘image’, aunque
en un primer momento solo existe ‘rect’. La opción target es un selector CSS
o una referencia directa al elemento objetivo.</p> <ul><li>Si es un selector, trabajará con el primer elemento que encuentre con ese selector, o lanzará excepción si no encuentra nada.</li> <li>Creará un elemento SVG que añadirá como hijo al body.</li> <li>Dicho SVG debe estar posicionado absolutamente sobre el elemento a señalar.</li> <li>Dicho SVG debe tener un tamaño similar al elemento a señalar. <ul><li>Digo similar porque podría ser más grande, si quiere rodearse sin taparlo.</li></ul></li></ul> <p>En las primeras iteraciones de herramientas gráficas me gusta centrarme en la exploración tecnológica. Hacer un caso mínimo funcional que dé un resultado visual inmediato.</p> <h3>Especificaciones formales con algún framework de testing</h3> <p>Aquí empieza lo realmente interesante. Hay que testar visualmente, eso está
claro, estamos ante una librería cuyo objetivo es renderizar cosas. Pero eso no
significa que inmediatamente todo vaya a ser regresión visual y E2E.
Considera la siguiente spec:</p> <div class="code-wrapper svelte-pnnny8" style="--lang-color: #3178c6"><!--[--><div class="code-wrapper__lang svelte-pnnny8">TypeScript</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-typescript svelte-pnnny8"><!----><!---->describe('create(...)', ()=>{
    ...
    it('creates an SVG and appends it to the body', ()=>{
        ...
    })
})<!----></code></pre></div><!----> <p>Esto no requiere renderizado. Vale con un DOM virtual, comprobar que se crea
un nuevo nodo y si queda colgando del body. Hacer una prueba E2E para esto es
matar moscas a cañonazos.</p> <h2>Especificación visual</h2> <p>Me gusta la <em>regresión visual</em>, pero tiene un pequeño problema. Por si no sabes
de qué te estoy hablando, consiste en la generación y comparación mediante
snapshots <em>(ficheros que describan el estado de una aplicación ante
ciertas condiciones. Típicamente suelen ser screenshots)</em>. Su fortaleza
reside en la cobertura futura. Por lo general se
generan snapshots una vez se tiene el resultado buscado para que en futuras
comparaciones tras refactoring recibamos un feedback de si algo ha cambiado más
de lo esperado.</p> <p>Y aunque es una herramienta útil y bienvenida en mantenimiento de aplicaciones
que controlan muy bien la interfaz de usuario y donde es crítico que estas no
cambien inesperadamente, la regresión visual no forma exactamente parte del
flujo de las metodologías estilo TDD, BDD o ATDD. Recordemos que son
metodologías de diseño y <strong>la regresión visual no aporta nada en la fase de diseño o para definir especificaciones preimplementación.</strong></p> <h3>Buscando la alternativa a la regresión visual</h3> <p>La siguiente forma de proceder y opiniones son, hasta donde sé, de <span class="no-wrap svelte-49cqox"><!----><!---->Cosexa Pgropia™<!----></span><!---->. No he hecho una investigación exhaustiva ni
sé si hay autores que han escrito sobre esto a favor o en contra. Por eso no
asumas nada de lo que expongo aquí, evita todo prejuicio positivo y afila la
sospecha y la duda.</p> <p>El proceso que he realizado es el siguiente: adaptar una biblioteca o framework
con capacidades para regresión visual (en este caso Playwright) para que
en su lugar genere screenshots de dos páginas distintas y
las compare. Una de las páginas presenta el escenario donde ejecutas la acción
a probar; la otra es la versión con el resultado final esperado, hecha a mano
y centrándonos solo en el resultado visual.</p> <p>Supongamos la siguiente especificacion:</p> <div class="code-wrapper svelte-pnnny8" style="--lang-color: #3178c6"><!--[--><div class="code-wrapper__lang svelte-pnnny8">TypeScript</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-typescript svelte-pnnny8"><!----><!---->describe("create('rect', {...})", ()=> {
    ...
    describe('Default behaviors (no options)', () => {
        ...
        it('creates an orange rect of 4px width around target', ()=>{
            ...
        })
    })
})<!----></code></pre></div><!----> <p>Nuestro escenario de pruebas podría contener, entre otras cosas, lo siguiente:</p> <div class="columns-container svelte-1dlijvy" style="--gap: 4px"><div class="columns-container__left svelte-1dlijvy" style="width: 50%"><!----><div class="code-wrapper svelte-pnnny8" style="--lang-color: #e34c26"><!--[--><div class="code-wrapper__lang svelte-pnnny8">HTML</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-html svelte-pnnny8"><!----><!---->&lt;div class="test-box">&lt;/div><!----></code></pre></div><!----></div> <div class="columns-container__right svelte-1dlijvy" style="width: 50%"><!----><div class="code-wrapper svelte-pnnny8" style="--lang-color: #2965f1"><!--[--><div class="code-wrapper__lang svelte-pnnny8">CSS</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-css svelte-pnnny8"><!----><!---->.test-box {
    background: #333;
    width: 250px;
    height: 150px;
}<!----></code></pre></div><!----></div></div><!----> <div class="example svelte-1e8u39k"><div class="test-box svelte-1e8u39k" style="width: 250px; height: 150px"></div></div><!----> <p>Y por otra parte, una página copia modificada con el resultado VISUAL esperado</p> <div class="columns-container svelte-1dlijvy" style="--gap: 4px"><div class="columns-container__left svelte-1dlijvy" style="width: 50%"><!----><div class="code-wrapper svelte-pnnny8" style="--lang-color: #e34c26"><!--[--><div class="code-wrapper__lang svelte-pnnny8">HTML</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-html svelte-pnnny8"><!----><!---->&lt;div class="test-box test-box--expected">&lt;/div><!----></code></pre></div><!----></div> <div class="columns-container__right svelte-1dlijvy" style="width: 50%"><!----><div class="code-wrapper svelte-pnnny8" style="--lang-color: #2965f1"><!--[--><div class="code-wrapper__lang svelte-pnnny8">CSS</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-css svelte-pnnny8"><!----><!---->...
.test-box--expected {
    box-sizing: content-box;
    border: 4px solid orange;
}
<!----></code></pre></div><!----></div></div><!----> <div class="example svelte-1e8u39k"><div class="test-box svelte-1e8u39k test-box--expected" style="width: 250px; height: 150px"></div></div><!----> <p>SÉ LO QUE ESTÁS PENSANDO (o deberías): “pero Alexander, en el esperado no hay
ningún SVG, ¡solo le has puesto un borde naranja de 4 píxeles al elemento!”</p> <p>A esto es a lo que me refiero con especificación visual. Podría haber un SVG
hecho a mano (de hecho los hay en specs más complejas) y seguiría siendo válido,
pero en realidad no importa la estructura,
no es lo que estamos especificando ni testando aquí.</p> <p>Al igual que con tests convencionales, buscamos la forma menos compleja y más
directa de definir lo que queremos (en este caso lo que queremos visualmente).</p> <p>Créeme, esto no lo hago por mejorar la adaptabilidad y reducir la fragilidad del
test, aunque sean sus efectos positivos principales, sino porque simplemente es la
forma más sencilla que se me ha ocurrido de conseguir lo que se busca visualmente.</p> <p>En una clásica “especificación por ejemplo” con GIVEN-WHEN-THEN, esta parte
correspondería al THEN, y al igual que en las especificaciones convencionales,
debe expresarse de la forma más directa y clara atendiendo en este caso
exclusivamente al resultado visible (ya que es la única responsabilidad en
estos tests).</p> <p>Veamos un test similar al del Mundo Real™. El original y funcional lo tienes
en el repositorio (enlace al final). Es un test parametrizado, se genera con variaciones de
expectedWidth (xW) y expectedHeight (xH).</p> <div class="code-wrapper svelte-pnnny8" style="--lang-color: #3178c6"><!--[--><div class="code-wrapper__lang svelte-pnnny8">TypeScript</div><!--]--> <div class="code-wrapper__buttons svelte-pnnny8"><!--[!--><!--]--> <!--[!--><!--]--></div> <pre class="svelte-pnnny8"><code class="language-typescript svelte-pnnny8"><!----><!---->it(`creates an orange rect of 4px width around target (${xW}x${xH})`, async ({ page }) => {
    await comparePages({
        testingURL: `/${xW}x${xH}`,
        expectedURL: `/expected/rect/${xW}x${xH}-default`,
        action: () => {
            return page.evaluate(() => {
                pio.create('rect', {target: `.test-box--${xW}x${xH}`})
            })
        }
    })
})<!----></code></pre></div><!----> <small>NOTA: que veas tanta especificidad como
orange o 4px, algo que no suele ser recomendado en specs/tests, es normal en este caso porque
estamos especificando los valores default, es de las pocas excepciones a la regla.</small> <p>La función es autoexplicativa. Recibe la página donde se ejecutará la acción
a testar, la página con la que comparar, y la acción a realizar. Tras lanzar el
test debería fallar al no tener implementación inicialmente.
El test report de Playwright en este caso me reporta una comparación de
múltiples formas, entre ellas una muy chula con un slider. Captura:</p> <!--[!--><div class="image-wrapper"><a href="/_app/immutable/assets/captura-error.DS5ipSG-.png" target="_blank"><img src="/_app/immutable/assets/captura-error.DS5ipSG-.png" alt="Test report de Playwright mostrando resultado actual y esperado con slider" class="svelte-u0jlpn"/></a></div><!--]--><!----> <div class="info-box svelte-um5er8"><!--[!--><!--]--> <!----><!---->Lamentablemente Playwright no tiene una función tan mágica y bonita como
comparePages. Es propia, resultado de un poco de 
hacking con los mecanismos de regresión visual de Playwright, pero tienes total
libertad para meterle un copia y pega (hazlo del repo, que es la que funciona).<!----></div><!----> <h4>Sólo lo visible</h4> <p>Tengo que insistir en que sólo hago esto con fines de testar el resultado
visual. Puede que te preguntes algo como “¿No estás perdiendo la oportunidad
de especificar directamente un resultado final que sirva también de
especificación del DOM deseado para una prueba E2E completa?”</p> <p>No conozco (todavía) el DOM deseado y no puedo <em>perder tiempo</em> planificando.
Esto me permite especificar el
resultado visual, que es lo único que tengo claro ahora mismo. Además los SVG
para un mismo objetivo se pueden generar de múltiples maneras. Exagerar el
detalle aumenta la rigidez del diseño, no permite posponer decisiones y aumenta
la fragilidad de los tests.</p> <p>Por otra parte también nos limitaría más con escenarios menos deterministas.
Imagina que quieres que el recuadro
siga al elemento si este se reposiciona (típico al reescalar pantalla).
Esto es algo que debe hacer la biblioteca, ¿cómo especificaríamos algo así?
Implicaría lógica en el propio test. En los expects
se evitan lógicas complejas a favor de resultados directos deterministas.
Un borde por CSS no solo está fijado a un elemento, también funciona aunque
reescales o lo muevas.</p> <h3>Otras preguntas relacionadas que me he planteado</h3> <p>¿Por qué hacer un esfuerzo en especificar partes del aspecto visual esperado
en un desarrollo si muy probablemente haya partes que no
podremos especificar de todas formas?, ¿no es como intentar construir una casa
en la que sabemos de antemano que nunca tendremos techo o alguna otra parte
fundamental?</p> <p>Ya tenemos la respuesta en la jerarquía de tests. Sabemos que las pruebas
unitarias no nos sirven para todo, ni tampoco las de integración. Pero lo
hacemos igualmente porque nos guían y cubren el desarrollo, cada una a su
manera, con pros y contras. Técnicamente podríamos usar solo tests de aceptación
si estos fueran infinitamente rápidos, y aún así, muy probablemente se seguirían
realizando pruebas unitarias y de integración junto a ellos.</p> <p>Puedes tener un muy buen maquetador, diseñador, artista o artista técnico en tu
equipo durante el desarrollo de una aplicación, con capacidad para
diseñar/especificar rápidamente el resultado que quieres pero sin competencias o tiempo
para realizar la herramienta que produzca ese resultado.</p> <p>He conocido empresas que trabajan con un flujo basado en
prototipos, y eso está perfecto, pero podría ser muy útil entender esos
prototipos como especificaciones y realizar pruebas directas contra ellos.</p> <h3>¿Cómo de útil es esto realmente?</h3> <p>La respuesta es algo evidente: si fuera muy útil habría
literatura al respecto y alguna que otra herramienta conocida. Créeme, no soy
ningún genio extendiendo el estado del arte. Esta “técnica”
viene de perlas para el desarrollo de esta biblioteca en concreto, pero, ¿se
te ocurre alguna otra? No es especialmente extrapolable. Ni siquiera es
suficiente para todos los casos de esta biblioteca.</p> <p>Voy a describirte un caso difícil de explicar: imagina que quieres
señalizar con una flecha que apunta siempre a un objetivo.
Supón que incluso aunque este se mueva en pantalla la flecha mantenga su
posición y gire apuntando siempre al objetivo (un “look at” en gráficos).</p> <p>La descripción anterior es incluso difícil de imaginar para algunos, supone
problemas en cómo especificarla y cómo testarla. Y ni siquiera es algo realmente
complejo. En las artes visuales muchas
veces no queda más remedio que romper el orden rojo-verde porque el esfuerzo de
especificar puede ser indistinguible del de implementar.</p> <p>Es ahí donde destaca la regresión visual clásica. Implementas y cuando estés
satisfecho, snapshot que servirá como “expected”. No te habrá servido para
guiar tu diseño e implementación, pero seguirás protegiendo tu código y
permitiendo el refactoring.</p> <p>Pero no olvides que al final eres tú (o tu equipo) quien decide si cualquier
técnica es o no rentable de aplicar en el flujo de trabajo. Incluso aunque
existiera garantía de que aplicarlo mejorase la productividad o calidad,
podría causar el efecto contrario si diezma la moral al percibirse como
algo pesado, raro o molesto por mera falta de costumbre. La misma historia
del TDD.</p> <h2>Point it out como posible ejemplo de especificación visual</h2> <p>Puedes seguir el desarrollo de <a href="https://github.com/alexvgjm/point-it-out" rel="nofollow">Point it out! en github</a>,
donde verás que hay mucho de lo hablado en este artículo llevado a un
nivel enfermizo. Es un proyecto pensado para experimentar y debatir
acerca de las posibilidades de la especificación visual.</p> <p>Si clonas y ejecutas el proyecto en modo de desarrollo podrás encontrar una
jerarquía de especificaciones bastante intensa para al menos dos formas y
dos tamaños de objetivos.
Aquí una screenshot:</p> <!--[!--><div class="image-wrapper"><a href="/_app/immutable/assets/visual-specs-index.DUyx9Wot.png" target="_blank"><img src="/_app/immutable/assets/visual-specs-index.DUyx9Wot.png" alt="" class="svelte-u0jlpn"/></a></div><!--]--><!----><!----></article><!----><!----><!----><!--]--><!----></main> <footer class="svelte-1pvwjww">Alexander Vega © 2025</footer><!----><!--]--><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1kme73p = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.Z99xSRbY.js"),
						import("../_app/immutable/entry/app.DQ3YaMDD.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 4, 6, 18],
							data: [null,null,{type:"data",data:{post:{title:"Especificación visual. Caso Point it out!",slug:"especificacion-visual-caso-point-it-out",coverImage:"pio-round-fail-test.png",coverAuthor:"",excerpt:"Caso de un proyecto en activo para el que repaso el concepto de regresión visual y especificación visual. Contenido denso.",date:"2024-07-25T15:06:23.177Z",updated:"2024-07-25T15:06:23.903Z",hidden:false,tags:["TDD/BDD/ATDD","Tooling","DX"],keywords:["svg","regresión visual","visual testing"],type:"default",coverPosition:"top",path:"/src/posts/especificacion-visual-caso-point-it-out.md",html:void 0,relatedPosts:[{title:"Deja de esperar por otros",slug:"deja-esperar-otros",coverImage:"jon-tyson.jpg",coverPosition:"normal",coverAuthor:"Jon Tyson",excerpt:"Hacerte tus propias herramientas puede acelerar tu trabajo, explico por qué.",date:"2024-09-13T13:00:23.177Z",updated:"2024-09-13T13:00:23.903Z",hidden:false,tags:["Tooling","Three.js","DX"],keywords:["herramientas","esperar","Three"],type:"default",fullReload:false,path:"/src/posts/deja-esperar-otros.md",html:void 0},{title:"🔴 Caso de la suite Cosby",slug:"caso-suite-cosby",coverImage:"blizzard.jpg",coverPosition:"normal",coverAuthor:"Annie Nyle",excerpt:"Repaso algunas experiencias con este caso, implicados, nuestra postura y resultados.",date:"2024-10-06T13:00:23.177Z",updated:"2024-10-06T13:00:23.903Z",hidden:false,tags:["Personal","Tooling"],keywords:["Blizzard"],type:"default",fullReload:false,path:"/src/posts/caso-suite-cosby.md",html:void 0},{title:"Cuántas muertes evitables...",slug:"cuantas-muertes-evitables",coverAuthor:"",excerpt:"He publicado una lista de errores comunes un pelín alarmista.",date:"2025-03-27T22:38:29.122Z",updated:"2025-03-27T22:38:29.122Z",hidden:false,tags:["TDD/BDD/ATDD","Ingeniería software"],keywords:["smells","tests"],type:"default",coverPosition:"top",coverImage:void 0,path:"/src/posts/cuantas-muertes-evitables.md",html:void 0}],month:"07",day:"25"}},uses:{params:["slug"]}},{type:"data",data:{post:{title:"Especificación visual. Caso Point it out!",slug:"especificacion-visual-caso-point-it-out",coverImage:"pio-round-fail-test.png",coverAuthor:"",excerpt:"Caso de un proyecto en activo para el que repaso el concepto de regresión visual y especificación visual. Contenido denso.",date:"2024-07-25T15:06:23.177Z",updated:"2024-07-25T15:06:23.903Z",hidden:false,tags:["TDD/BDD/ATDD","Tooling","DX"],keywords:["svg","regresión visual","visual testing"],type:"default",coverPosition:"top",path:"/src/posts/especificacion-visual-caso-point-it-out.md",html:void 0,relatedPosts:[{title:"Deja de esperar por otros",slug:"deja-esperar-otros",coverImage:"jon-tyson.jpg",coverPosition:"normal",coverAuthor:"Jon Tyson",excerpt:"Hacerte tus propias herramientas puede acelerar tu trabajo, explico por qué.",date:"2024-09-13T13:00:23.177Z",updated:"2024-09-13T13:00:23.903Z",hidden:false,tags:["Tooling","Three.js","DX"],keywords:["herramientas","esperar","Three"],type:"default",fullReload:false,path:"/src/posts/deja-esperar-otros.md",html:void 0},{title:"🔴 Caso de la suite Cosby",slug:"caso-suite-cosby",coverImage:"blizzard.jpg",coverPosition:"normal",coverAuthor:"Annie Nyle",excerpt:"Repaso algunas experiencias con este caso, implicados, nuestra postura y resultados.",date:"2024-10-06T13:00:23.177Z",updated:"2024-10-06T13:00:23.903Z",hidden:false,tags:["Personal","Tooling"],keywords:["Blizzard"],type:"default",fullReload:false,path:"/src/posts/caso-suite-cosby.md",html:void 0},{title:"Cuántas muertes evitables...",slug:"cuantas-muertes-evitables",coverAuthor:"",excerpt:"He publicado una lista de errores comunes un pelín alarmista.",date:"2025-03-27T22:38:29.122Z",updated:"2025-03-27T22:38:29.122Z",hidden:false,tags:["TDD/BDD/ATDD","Ingeniería software"],keywords:["smells","tests"],type:"default",coverPosition:"top",coverImage:void 0,path:"/src/posts/cuantas-muertes-evitables.md",html:void 0}],month:"07",day:"25"}},uses:{params:["slug"]}}],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
